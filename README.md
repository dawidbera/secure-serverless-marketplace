# Secure Serverless Marketplace

A high-performance, secure backend for a digital marketplace designed to master **modern cloud-native patterns** domains.

## üèó Architecture
- **Compute:** AWS Lambda (Java 17)
- **API:** Amazon API Gateway
- **Database:** Amazon DynamoDB
- **Security:** AWS KMS, Secrets Manager, IAM
- **Infrastructure:** AWS SAM + LocalStack

## üöÄ Getting Started

### Prerequisites
- Docker & Docker Compose
- Java 17+ & Maven
- AWS SAM CLI & AWS CLI (or `awslocal`)

### 1. Start Local Environment
Start LocalStack and Redis containers:
```bash
docker-compose up -d
```

### 2. Build the Project
Compile the Java code and package it as a shaded JAR:
```bash
sam build
```

### 3. Deploy to LocalStack
Deploy the SAM application to the local emulated cloud:
```bash
samlocal deploy --stack-name marketplace-stack --resolve-s3 --capabilities CAPABILITY_IAM --region us-east-1
```
*(Note: If you don't have `samlocal`, use `sam deploy` with `--endpoint-url http://localhost:4566`)*

### 4. Test the API
Retrieve the API endpoint and test it:
```bash
# Get the API ID (auto-generated by LocalStack)
awslocal apigateway get-rest-apis

# Test the endpoint (replace API_ID)
curl -k https://localhost:4566/restapis/<API_ID>/Prod/_user_request_/products
```

## üìö Key Technical Features
- **DynamoDB:** Single-table design, Optimistic Locking.
- **Security:** KMS Encryption, Secrets Rotation.
- **Optimization:** Lambda SnapStart, Layers.

## üß† Technical Lessons Learned (Gotchas)
- **Single Table Design:** Using `PK` and `SK` prefixes (e.g., `PROD#<id>`) allows for flexible querying within a single table, reducing the need for multiple joins.
- **Java in Serverless:** Shaded JARs are essential for Lambda functions to include all necessary dependencies (like AWS SDK for DynamoDB).
- **LocalStack Compatibility:** Always use `awslocal` or provide the `--endpoint-url` when testing locally to ensure requests are routed to the container instead of the real AWS.
